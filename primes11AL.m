primes := [ 23, 47, 71, 167, 191, 239, 263, 311, 359, 383, 431, 479, 503, 599, 647, 719, 743, 839, 863, 887, 911, 983, 1031, 1103, 1151, 1223, 1319, 1367, 
1439, 1487, 1511, 1559, 1583, 1607, 1823, 1847, 1871, 2039, 2063, 2087, 2111, 2207, 2351, 2399, 2423, 2447, 2543, 2591, 2663, 2687, 2711, 2879, 
2903, 2927, 2999, 3023, 3119, 3167, 3191, 3359, 3407, 3527, 3623, 3671, 3719, 3767, 3863, 3911, 4007, 4079, 4127, 4271, 4391, 4463, 4583, 4679, 
4703, 4751, 4799, 4871, 4919, 4943, 4967, 5039, 5087, 5231, 5279, 5303, 5351, 5399, 5471, 5519, 5591, 5639, 5711, 5783, 5807, 5879, 5903, 5927, 
6047, 6143, 6263, 6287, 6311, 6359, 6551, 6599, 6719, 6791, 6863, 6911, 6959, 6983, 7079, 7103, 7127, 7151, 7247, 7487, 7559, 7583, 7607, 7703, 
7727, 7823, 7919, 8039, 8087, 8111, 8231, 8423, 8447, 8543, 8663, 8783, 8807, 8831, 8951, 8999, 9239, 9311, 9431, 9479, 9551, 9623, 9719, 9743, 
9767, 9791, 9839, 9887, 10007, 10079, 10151, 10223, 10247, 10271, 10391, 10463, 10487, 10559, 10607, 10631, 10799, 10847, 11087, 11159, 11279, 
11351, 11399, 11423, 11447, 11471, 11519, 11783, 11807, 11831, 11903, 11927, 12071, 12119, 12143, 12239, 12263, 12479, 12503, 12527, 12647, 12671, 
12743, 12791, 12911, 12959, 12983, 13103, 13127, 13151, 13367, 13463, 13487, 13679, 13751, 13799, 13967, 14087, 14159, 14207, 14303, 14327, 14423, 
14447, 14519, 14543, 14591, 14639, 14759, 14783, 14831, 14879, 14951, 15263, 15287, 15359, 15383, 15551, 15671, 15767, 15791, 15887, 15959, 16007, 
16103, 16127, 16319, 16487, 16607, 16631, 16703, 16823, 16871, 16943, 17159, 17183, 17231, 17327, 17351, 17471, 17519, 17783, 17807, 18047, 18119, 
18143, 18191, 18287, 18311, 18671, 18719, 18743, 18839, 18911, 18959, 19031, 19079, 19319, 19391, 19463, 19559, 19751, 19919, 19991, 20063, 20231, 
20327, 20399, 20543, 20639, 20663, 20759, 20807, 20879, 21143, 21191, 21383, 21407, 21503, 21599, 21647, 21839, 21863, 21911, 22031, 22079, 22271, 
22343, 22391, 22511, 22679, 22727, 22751, 22871, 23039, 23063, 23087, 23159, 23279, 23327, 23399, 23447, 23663, 23687, 23831, 23879, 24023, 24071, 
24239, 24359, 24527, 24551, 24671, 24767, 25031, 25247, 25343, 25367, 25391, 25439, 25583, 25679, 25703, 25847, 25919, 26111, 26183, 26399, 26591, 
26711, 26759, 26783, 26879, 26927, 27191, 27239, 27431, 27479, 27527, 27551, 27743, 27767, 27791, 27983, 28031, 28151, 28439, 28559, 28607, 28703, 
28751, 28871, 29207, 29231, 29399, 29567, 29759, 29879, 30047, 30071, 30119, 30431, 30671, 30839, 30911, 31079, 31151, 31247, 31271, 31319, 31391, 
31511, 31751, 31799, 31991, 32159, 32303, 32423, 32831, 32999, 33071, 33119, 33311, 33359, 33479, 33599, 33647, 33791, 33911, 34031, 34319, 34439, 
34487, 34511, 34583, 34631, 34679, 34919, 35111, 35159, 35279, 35447, 35591, 35759, 35831, 35879, 35951, 35999, 36191, 36263, 36479, 36599, 36671, 
36767, 36791, 37463, 37511, 37799, 37847, 37991, 38039, 38183, 38231, 38351, 38639, 38711, 39023, 39119, 39191, 39359, 39551, 39623, 39791, 39839, 
40031, 40127, 40151, 40559, 40751, 40823, 41039, 41399, 41879, 41999, 42071, 42239, 42719, 42839, 43151, 43319, 43391, 43991, 44159, 44351, 44519, 
44711, 44879, 45119, 45191, 45959, 46199, 46439, 46511, 46679, 46751, 46919, 47111, 47351, 47591, 47711, 48023, 48311, 48479, 49199, 49391, 49559, 
49871, 50111, 50231, 50591, 50951, 51047, 51071, 51239, 51479, 51719, 52391, 52511, 52631, 52919, 53231, 53279, 53591, 53639, 53759, 53831, 54311, 
55079, 55439, 55799, 56591, 56711, 56951, 56999, 57119, 57791, 57839, 58439, 58511, 58631, 58679, 59351, 59471, 60719, 61031, 61151, 61631, 61871, 
61991, 62039, 63311, 63671, 63719, 63839, 64151, 64319, 64679, 65519, 65831, 66071, 66239, 66359, 66791, 67679, 68351, 69431, 70199, 70439, 71399, 
71711, 72959, 73079, 74231, 75479, 76079, 76991, 77591, 79631, 80471, 82799, 83639, 87071, 87359, 88079, 88919, 95471, 97919, 104711 ];
primes := primes cat [ 11, 59, 83, 107, 131, 179, 227, 251, 347, 419, 443, 467, 491, 563, 587, 659, 

683, 827, 947, 971, 1019, 1091, 1163, 1187, 1259, 1283, 1307, 1427, 1451, 1499, 

1523, 1571, 1619, 1667, 1787, 1811, 1907, 1931, 1979, 2003, 2027, 2099, 2243, 

2267, 2339, 2411, 2459, 2531, 2579, 2699, 2819, 2843, 2939, 2963, 3011, 3083, 

3203, 3251, 3299, 3323, 3347, 3371, 3467, 3491, 3539, 3659, 3779, 3803, 3851, 

3923, 3947, 4019, 4091, 4139, 4211, 4259, 4283, 4451, 4523, 4547, 4643, 4691, 

4787, 4931, 5003, 5051, 5099, 5147, 5171, 5387, 5483, 5507, 5531, 5651, 5843, 

5867, 5939, 6011, 6131, 6203, 6299, 6323, 6491, 6563, 6659, 6779, 6803, 6899, 

6947, 6971, 7019, 7043, 7187, 7211, 7283, 7307, 7331, 7451, 7499, 7523, 7643, 

7691, 7907, 8147, 8219, 8291, 8363, 8699, 8819, 8867, 8963, 9011, 9059, 9203, 

9227, 9323, 9371, 9419, 9467, 9491, 9539, 9803, 9851, 10091, 10139, 10163, 

10211, 10259, 10331, 10427, 10499, 10667, 10691, 10739, 10859, 10979, 11171, 

11411, 11483, 11579, 11699, 11987, 12011, 12227, 12251, 12491, 12539, 12611, 

12659, 12899, 13163, 13259, 13331, 13451, 13499, 13523, 13691, 13859, 13907, 

14051, 14411, 14699, 14747, 14771, 14843, 14867, 14891, 15083, 15131, 15683, 

15731, 15971, 16091, 16691, 16763, 16811, 16883, 16931, 16979, 17027, 17099, 

17291, 17387, 17579, 17891, 17939, 18059, 18131, 18251, 18443, 18539, 18899, 

19139, 19211, 19379, 19571, 19739, 20051, 20219, 20411, 20627, 21059, 21419, 

21467, 21611, 22091, 22259, 22571, 22739, 22811, 23099, 23339, 23819, 24251, 

24371, 24419, 24659, 25931, 26099, 26171, 26699, 27011, 27179, 27299, 27611, 

27851, 28019, 28619, 28859, 29411, 29531, 29819, 31139, 31379, 33851, 35339, 

36011, 37691, 39779, 41051, 41411, 42899, 44651, 48179, 49139, 49451 ];

print(#primes);

no_ss := [];
ALbad := [];
for p in primes do
	ssp := SupersingularPolynomial(p);
	K := GF(p^2);
	rts := Roots(ssp, K);

	fp_rts := [];
	other_rts := [];
	for rt in rts do
		err := rt[1] - Frobenius(rt[1]);
		if err ne 0 then
			Append(~other_rts, rt[1]);
		else
			Append(~fp_rts, rt[1]);
		end if;
	end for;
	
	if #other_rts eq 0 then
		Append(~no_ss, p);
		continue;
	end if;
	
	good := false;
	for rt in other_rts do
		tot := 1;
		for ssj in fp_rts do
			tot := tot * (rt - ssj);
		end for;

		err := tot - Frobenius(tot);
		if err ne 0 then
			good := true;
			break;
		end if;
	end for;
	
	if not good then
		Append(~ALbad, p);
	end if;	
end for;
